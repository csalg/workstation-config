---
- hosts: localhost
  # connection: local # If this is set to local it ignores the port for some reason
  become: true

  vars:
    graphical: false
    dev: false
    personal: false

  # TODO: pacman -Ssyuu maybe
  tasks:
    # - name: "Ansible | List all known variables and facts"
    #   debug:
    #     var: hostvars[inventory_hostname]

    - name: Install basic command-line tools
      community.general.pacman:
        name: "{{ item }}"
        state: present
      loop:
        - zoxide
        - bat
        - pcmanfm
        - python-scikit-learn
        - ansible
        - flameshot # screenshot capture tool
        - bluez-utils # cli interface for bluetooth (bluetoothcli)
        - blueman # applet for bluetooth
        - tmux
        - neovim
        - stow
        - fzf
        - ripgrep
        - ncurses
        - zsh
        - htop
        - python3
        - python-pip
        - taskell
        - zsh-autosuggestions
        - zsh-completions
        - grep
        - git
        - curl
        - gnutls
        - go
        - sudo
        - alacritty
        - wget
        - which
        - tree
        - ranger
    - name: Change shell
      shell: chsh -s `which zsh`
    

    - name: Install zsh-autosuggestions
      ansible.builtin.git:
        repo: https://github.com/zsh-users/zsh-autosuggestions
        dest: ~/.oh-my-zsh/custom/plugins

    - name: Install graphical stuff
      community.general.pacman:
        name: "{{ item }}"
        state: present
      loop:
        - zathura
        - thunderbird
        - sqlite
        - firefox
        - rofi
        - arandr
        - pavucontrol
        - barrier
        - i3lock
        - i3status
      when: graphical
      tags:
        - graphical

    - name: Install dev stuff
      community.general.pacman:
        name: "{{ item }}"
        state: present
      loop:
        - npm
        - yarn
        - kubectl
        - go
        - alacritty
      when: dev

    - name: Install personal stuff
      community.general.pacman:
        name: "{{ item }}"
        state: present
      loop:
        - telegram-desktop
        - shadowsocks-qt5
        - darktable
        - calibre
      when: personal

    - name: Install stuff using `pip`
      pip:
        name: "{{ item }}"
      loop:
        - jupyter
        - numpy
        - matplotlib
        - seaborn
        - flask
      tags:
        - pip

    - name: Enable services
      ansible.builtin.systemd:
        name: "{{ item }}"
        enabled: yes
        masked: no
      loop:
        - systemd-networkd
        - iwd
        - sshd
      tags:
        - systemd
